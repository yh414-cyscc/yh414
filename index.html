<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Flower</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
html, body {
    margin: 0;
    padding: 0;
    background: black;
    overflow: hidden;
    height: 100%;
}
canvas { display: block; }
#hint {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: white;
    font-family: Arial, sans-serif;
    font-size: 24px;
    opacity: 0.9;
    pointer-events: none;
    transition: opacity 0.8s ease;
}
</style>
</head>
<body>

<div id="hint">click here to get a flower &lt;3</div>
<canvas id="canvas"></canvas>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const hint = document.getElementById("hint");

function resize() {
    canvas.width = innerWidth;
    canvas.height = innerHeight;
}
resize();
addEventListener("resize", resize);

const ease = t =>
    t < 0.5 ? 4 * t * t * t : 1 - Math.pow(-2 * t + 2, 3) / 2;

class Flower {
    constructor(x, y) {
        this.x = x;
        this.baseY = y;
        this.height = 150 + Math.random() * 220;
        this.t = 0;
        this.speed = 0.006 + Math.random() * 0.004;
        this.curve = (Math.random() - 0.5) * 5;
        this.type = ["rose", "chrysanthemum", "sakura", "lavender"]
            [Math.floor(Math.random() * 4)];
    }

    stem(p) {
        ctx.strokeStyle = "#2f6f4e";
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.moveTo(this.x, this.baseY);
        for (let i = 0; i <= 30; i++) {
            const k = (i / 30) * p;
            ctx.lineTo(
                this.x + Math.sin(k * Math.PI) * this.curve,
                this.baseY - this.height * k
            );
        }
        ctx.stroke();
    }

    leaves(p) {
        if (p < 0.4) return;
        ctx.fillStyle = "#3f8f66";
        [0.45, 0.6, 0.72].forEach((pos, i) => {
            if (p > pos) {
                const y = this.baseY - this.height * pos * p;
                const dir = i % 2 ? 1 : -1;
                ctx.beginPath();
                ctx.ellipse(this.x + dir * 11, y, 15, 7, dir * 0.6, 0, Math.PI * 2);
                ctx.fill();
            }
        });
    }

    bloom(top, b) {
        ctx.save();
        ctx.globalAlpha = b;

        if (this.type === "rose") {
            for (let layer = 3; layer >= 1; layer--) {
                ctx.fillStyle = layer === 1 ? "#7a0d1b" : "#b11226";
                for (let i = 0; i < 7 + layer; i++) {
                    ctx.beginPath();
                    ctx.ellipse(
                        this.x + Math.cos(i) * 6 * layer * b,
                        top + Math.sin(i) * 6 * layer * b,
                        10 * b,
                        14 * b,
                        i,
                        0,
                        Math.PI * 2
                    );
                    ctx.fill();
                }
            }
        }

        if (this.type === "chrysanthemum") {
            ctx.fillStyle = "#f4c430";
            for (let i = 0; i < 26; i++) {
                const r = 16 + Math.random() * 4;
                ctx.beginPath();
                ctx.ellipse(
                    this.x + Math.cos(i) * r * b,
                    top + Math.sin(i) * r * b,
                    6 * b,
                    13 * b,
                    i * 0.8,
                    0,
                    Math.PI * 2
                );
                ctx.fill();
            }
        }

        if (this.type === "sakura") {
            ctx.fillStyle = "#f6b3c8";
            for (let i = 0; i < 5; i++) {
                ctx.beginPath();
                ctx.ellipse(
                    this.x + Math.cos(i * 1.2) * 10 * b,
                    top + Math.sin(i * 1.2) * 10 * b,
                    12 * b,
                    18 * b,
                    i,
                    0,
                    Math.PI * 2
                );
                ctx.fill();
            }
        }

        if (this.type === "lavender") {
            for (let i = 0; i < 12; i++) {
                ctx.fillStyle = i % 2 ? "#9a6fd6" : "#7c5aa6";
                ctx.beginPath();
                ctx.ellipse(
                    this.x,
                    top - i * 8 * b,
                    5 * b,
                    10 * b,
                    0,
                    0,
                    Math.PI * 2
                );
                ctx.fill();
            }
        }

        ctx.restore();
    }

    update() {
        this.t = Math.min(1, this.t + this.speed);
        const p = ease(this.t);
        const top = this.baseY - this.height * p;

        this.stem(p);
        this.leaves(p);
        if (p > 0.65) this.bloom(top, (p - 0.65) / 0.35);
    }
}

const flowers = [];

function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    flowers.forEach(f => f.update());
    requestAnimationFrame(animate);
}
animate();

canvas.addEventListener("pointerdown", e => {
    hint.style.opacity = 0;
    flowers.push(new Flower(e.clientX, e.clientY));
});
</script>

</body>
</html>
